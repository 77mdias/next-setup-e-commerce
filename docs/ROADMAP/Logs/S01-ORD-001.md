# S01-ORD-001 - Exigir autenticacao obrigatoria em `/api/orders/session/[sessionId]`

**Data:** 2026-02-27  
**Status:** ✅ Concluida

## Resumo

Endpoint de consulta de pedido por `sessionId` foi mantido com autenticacao obrigatoria e resposta de erro segura para acessos anonimos.

## Implementacao aplicada

- Guard de autenticacao obrigatoria em `GET /api/orders/session/[sessionId]` com retorno `401`.
- Padronizacao da mensagem de erro para `Nao autorizado`, sem indicar detalhes sensiveis.
- Consulta de pedido vinculada ao `userId` autenticado para evitar acesso cruzado entre usuarios.
- Teste de integracao atualizado para validar a resposta anonima com erro padronizado.

## Arquivos alterados

- `src/app/api/orders/session/[sessionId]/route.ts`
- `src/app/api/orders/session/[sessionId]/__tests__/route.integration.test.ts`

## Validacoes

- `npm run lint` ✅ (com warnings preexistentes fora do escopo da task)
- `npm run build` ✅

## Riscos residuais

- Warnings de lint preexistentes em arquivos nao relacionados permanecem abertos para tratamento posterior.
